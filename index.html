import React, { useState, useMemo, useEffect } from 'react';
import { Calendar, UserPlus, CheckCircle, Circle, Trash2, GraduationCap, MapPin, AlertCircle, Database, Loader2, LogOut, Users, Settings, RefreshCw, ServerOff } from 'lucide-react';

// --- 데이터 정의 ---
const SCHEDULE_DATA = [
  { id: 'science', type: '과학고', dates: '2025. 8. 28.(목) ~ 9. 1.(월)', sortKey: '0828' },
  { id: 'meister', type: '마이스터고/예체능/특별(항공·해군)', dates: '2025. 10. 20.(월) ~ 10. 23.(목)', sortKey: '1020' },
  { id: 'special_special', type: '특성화고 특별전형', dates: '2025. 11. 24.(월) ~ 11. 25.(화)', sortKey: '1124' },
  { id: 'special_general', type: '특성화고 일반/고등기술/학력인정', dates: '2025. 12. 1.(월) ~ 12. 2.(화)', sortKey: '1201' },
  { id: 'general_principal', type: '학교장전형 일반고', dates: '2025. 12. 8.(월) ~ 12. 10.(수)', sortKey: '1208' },
  { id: 'foreign_intl', type: '외고/국제고/자사고', dates: '2025. 12. 8.(월) ~ 12. 10.(수)', sortKey: '1208' },
  { id: 'general_standard', type: '평준화적용 일반고', dates: '2025. 12. 8.(월) ~ 12. 10.(수)', sortKey: '1208' },
];

const BUKBU_SCHOOLS = [
  '구덕고', '금곡고', '낙동고', '만덕고', '부산강서고', '부산백양고', '사상고', 
  '화명고', '금명여고', '주례여고', '성도고', '경혜여고', '대덕여고'
];

export default function App() {
  // 앱 설정 및 상태
  const [gasUrl, setGasUrl] = useState(() => localStorage.getItem('hwamyeong_gas_url') || '');
  const [isSettingsOpen, setIsSettingsOpen] = useState(false);
  const [tempUrlInput, setTempUrlInput] = useState('');

  const [currentClass, setCurrentClass] = useState(() => localStorage.getItem('hwamyeong_class_2026') || '');
  const [tempClassInput, setTempClassInput] = useState('');

  const [allStudents, setAllStudents] = useState([]);
  const [loading, setLoading] = useState(false);
  const [isSaving, setIsSaving] = useState(false);

  // 폼 상태
  const [formNum, setFormNum] = useState('');
  const [formName, setFormName] = useState('');
  const [formType, setFormType] = useState('general_standard');
  const [formSchoolName, setFormSchoolName] = useState('');
  const [deleteModal, setDeleteModal] = useState({ isOpen: false, studentId: null, appId: null });

  // 구글 스프레드시트에서 데이터 불러오기 (GET)
  const fetchStudents = async () => {
    if (!gasUrl) return;
    setLoading(true);
    try {
      const response = await fetch(`${gasUrl}?className=${currentClass}`);
      if (!response.ok) throw new Error('Network response was not ok');
      const data = await response.json();
      setAllStudents(data);
    } catch (error) {
      console.error("데이터 불러오기 에러:", error);
      alert('스프레드시트에서 데이터를 불러오지 못했습니다. 주소가 정확한지 확인해주세요.');
    } finally {
      setLoading(false);
    }
  };

  // 접속 반이 바뀌거나 설정 주소가 있을 때 최초 로드
  useEffect(() => {
    if (gasUrl && currentClass) {
      fetchStudents();
    } else {
      setAllStudents([]); // URL이 없으면 목록 초기화
    }
  }, [gasUrl, currentClass]);

  // 설정 저장 핸들러
  const handleSaveSettings = () => {
    const url = tempUrlInput.trim();
    setGasUrl(url);
    localStorage.setItem('hwamyeong_gas_url', url);
    setIsSettingsOpen(false);
  };

  // 학급 진입 처리
  const handleEnterClass = (e) => {
    e.preventDefault();
    if (!tempClassInput.trim()) return alert('반을 입력해주세요.');
    const trimmedClass = tempClassInput.trim();
    setCurrentClass(trimmedClass);
    localStorage.setItem('hwamyeong_class_2026', trimmedClass);
  };

  // 학급 변경 처리
  const handleChangeClass = () => {
    setCurrentClass('');
    setTempClassInput('');
    localStorage.removeItem('hwamyeong_class_2026');
  };

  // 현재 반 학생 번호순 정렬
  const myClassStudents = useMemo(() => {
    return allStudents.sort((a, b) => parseInt(a.num) - parseInt(b.num));
  }, [allStudents]);

  // 구글 시트로 데이터 저장 (POST)
  const saveToSheet = async (action, studentId, updatedStudent = null) => {
    if (!gasUrl) {
      alert('설정에서 구글 웹 앱 URL을 먼저 등록해주세요!');
      return false;
    }
    
    setIsSaving(true);
    try {
      const payload = {
        action: action, // 'save' or 'delete'
        studentId: studentId,
        student: updatedStudent
      };

      await fetch(gasUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'text/plain;charset=utf-8' }, // CORS 방지용 text/plain
        body: JSON.stringify(payload)
      });
      return true;
    } catch (err) {
      console.error("구글 시트 저장 에러", err);
      alert('데이터 저장 중 오류가 발생했습니다.');
      return false;
    } finally {
      setIsSaving(false);
    }
  };

  // 학생 지원 추가
  const handleAddStudent = async (e) => {
    e.preventDefault();
    if (!gasUrl) return alert('설정(우측 상단 톱니바퀴)에서 구글 시트 웹 앱 URL을 먼저 연동해주세요.');
    if (!formNum || !formName || !formSchoolName) return alert('번호, 이름, 희망 학교명을 모두 입력해주세요.');

    const newApp = {
      id: Date.now().toString(),
      schoolType: formType,
      schoolName: formSchoolName,
      status: 'pending'
    };

    let updatedStudent;
    const existingStudent = myClassStudents.find(s => s.num === formNum);
    
    if (existingStudent) {
      updatedStudent = {
        ...existingStudent,
        name: formName,
        applications: [...existingStudent.applications, newApp]
      };
    } else {
      updatedStudent = {
        id: 's' + Date.now().toString(),
        className: currentClass,
        num: formNum,
        name: formName,
        applications: [newApp]
      };
    }

    // 시트에 저장 시도 후 화면 업데이트
    const success = await saveToSheet('save', updatedStudent.id, updatedStudent);
    if (success) {
      setAllStudents(prev => {
        const idx = prev.findIndex(s => s.id === updatedStudent.id);
        if (idx > -1) {
          const newArr = [...prev];
          newArr[idx] = updatedStudent;
          return newArr;
        }
        return [...prev, updatedStudent];
      });
      setFormNum('');
      setFormName('');
      setFormSchoolName('');
    }
  };

  // 접수 상태 토글
  const toggleStatus = async (studentId, appIdToToggle) => {
    const student = myClassStudents.find(s => s.id === studentId);
    if (!student) return;

    const updatedApps = student.applications.map(app => 
      app.id === appIdToToggle ? { ...app, status: app.status === 'pending' ? 'completed' : 'pending' } : app
    );
    const updatedStudent = { ...student, applications: updatedApps };

    const success = await saveToSheet('save', studentId, updatedStudent);
    if (success) {
      setAllStudents(prev => prev.map(s => s.id === studentId ? updatedStudent : s));
    }
  };

  const requestDelete = (studentId, appId) => {
    setDeleteModal({ isOpen: true, studentId, appId });
  };

  // 데이터 삭제 로직
  const confirmDelete = async () => {
    const { studentId, appIdToDelete } = { studentId: deleteModal.studentId, appIdToDelete: deleteModal.appId };
    const student = myClassStudents.find(s => s.id === studentId);
    if (!student) return;

    const updatedApps = student.applications.filter(a => a.id !== appIdToDelete);
    
    let success = false;
    if (updatedApps.length === 0) {
      // 모두 삭제되면 시트에서 행 자체 삭제
      success = await saveToSheet('delete', studentId);
      if (success) setAllStudents(prev => prev.filter(s => s.id !== studentId));
    } else {
      const updatedStudent = { ...student, applications: updatedApps };
      success = await saveToSheet('save', studentId, updatedStudent);
      if (success) setAllStudents(prev => prev.map(s => s.id === studentId ? updatedStudent : s));
    }

    setDeleteModal({ isOpen: false, studentId: null, appId: null });
  };

  const cancelDelete = () => {
    setDeleteModal({ isOpen: false, studentId: null, appId: null });
  };

  // --- 화면 1: 반 선택 진입 화면 ---
  if (!currentClass) {
    return (
      <div className="min-h-screen bg-slate-100 flex items-center justify-center p-4 font-sans">
        <div className="bg-white max-w-md w-full rounded-2xl shadow-xl overflow-hidden relative">
          <div className="bg-emerald-600 p-8 text-center text-white">
            <Database className="w-16 h-16 mx-auto mb-4 opacity-90" />
            <h1 className="text-2xl font-bold">2026학년도 고입 진학 관리</h1>
            <p className="text-emerald-100 mt-2">화명중학교 3학년 교사용 (구글 시트 연동)</p>
          </div>
          <form onSubmit={handleEnterClass} className="p-8 space-y-6">
            <div>
              <label className="block text-sm font-semibold text-slate-700 mb-2 text-center">
                선생님, 몇 반을 관리하시나요?
              </label>
              <div className="flex items-center gap-3">
                <input 
                  type="text" 
                  autoFocus
                  value={tempClassInput} 
                  onChange={(e) => setTempClassInput(e.target.value)}
                  className="flex-1 p-3 text-center text-xl font-bold border-2 border-slate-200 rounded-xl focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none transition-all" 
                  placeholder="예: 1"
                />
                <span className="text-xl font-bold text-slate-600">반</span>
              </div>
            </div>
            <button 
              type="submit" 
              className="w-full py-3.5 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-xl shadow-md transition-all flex items-center justify-center gap-2"
            >
              <Users className="w-5 h-5" />
              우리 반 관리 시작하기
            </button>
          </form>
        </div>
      </div>
    );
  }

  // --- 화면 2: 반별 관리 대시보드 ---
  return (
    <div className="min-h-screen bg-slate-50 font-sans p-4 md:p-8">
      <div className="max-w-6xl mx-auto space-y-6">
        
        {/* 헤더 */}
        <header className="bg-emerald-600 text-white p-6 rounded-2xl shadow-lg flex justify-between items-center gap-4 flex-wrap">
          <div className="flex items-center gap-4">
            <GraduationCap className="w-10 h-10" />
            <div>
              <h1 className="text-2xl font-bold flex items-center gap-2">
                화명중학교 3학년 <span className="text-yellow-300">{currentClass}반</span>
              </h1>
              <p className="text-emerald-100 mt-1 flex items-center gap-1.5">
                <Database className="w-3.5 h-3.5" /> 구글 스프레드시트 동기화 모드
              </p>
            </div>
          </div>
          <div className="flex items-center gap-3">
            {/* 데이터 동기화 상태 표시 */}
            {isSaving ? (
              <span className="hidden sm:flex items-center gap-1.5 text-sm font-medium bg-white/20 px-3 py-1.5 rounded-full">
                <Loader2 className="w-4 h-4 animate-spin" /> 시트 저장 중...
              </span>
            ) : gasUrl ? (
              <button 
                onClick={fetchStudents} 
                className="hidden sm:flex items-center gap-1.5 text-sm font-medium bg-emerald-700/50 hover:bg-emerald-700 px-3 py-1.5 rounded-full transition border border-emerald-400"
                title="데이터 새로고침"
              >
                <RefreshCw className={`w-4 h-4 ${loading ? 'animate-spin' : ''}`} /> 
                {loading ? '불러오는 중' : '시트 동기화 됨'}
              </button>
            ) : (
              <span className="hidden sm:flex items-center gap-1.5 text-sm font-medium bg-red-500/80 px-3 py-1.5 rounded-full text-white">
                <ServerOff className="w-4 h-4" /> 연결 안됨
              </span>
            )}

            {/* 설정 버튼 */}
            <button 
              onClick={() => {
                setTempUrlInput(gasUrl);
                setIsSettingsOpen(true);
              }}
              className="flex items-center gap-1.5 bg-white/10 hover:bg-white/20 px-3 py-2 rounded-lg text-sm font-medium transition-colors border border-white/20"
              title="스프레드시트 연동 설정"
            >
              <Settings className="w-4 h-4" />
              설정
            </button>
            
            {/* 반 변경 버튼 */}
            <button 
              onClick={handleChangeClass}
              className="flex items-center gap-1.5 bg-white/10 hover:bg-white/20 px-3 py-2 rounded-lg text-sm font-medium transition-colors border border-white/20"
            >
              <LogOut className="w-4 h-4" />
              반 변경
            </button>
          </div>
        </header>

        {/* 연동 경고창 */}
        {!gasUrl && (
          <div className="bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg shadow-sm flex items-start gap-3">
            <AlertCircle className="w-5 h-5 text-red-500 mt-0.5 shrink-0" />
            <div>
              <h3 className="text-red-800 font-bold mb-1">구글 스프레드시트가 연결되지 않았습니다!</h3>
              <p className="text-red-700 text-sm">현재 데이터를 입력해도 저장되지 않습니다. 우측 상단의 [설정] 버튼을 눌러 발급받으신 '웹 앱 URL'을 등록해주세요.</p>
            </div>
          </div>
        )}

        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
          {/* 좌측 패널: 전형 일정 & 학군 정보 */}
          <div className="space-y-6">
            <div className="bg-white p-5 rounded-2xl shadow-sm border border-slate-200">
              <h2 className="text-lg font-bold flex items-center gap-2 mb-4 text-slate-800">
                <Calendar className="w-5 h-5 text-emerald-500" />
                주요 고입 전형 일정 (원서접수)
              </h2>
              <div className="space-y-3">
                {SCHEDULE_DATA.map((item) => (
                  <div key={item.id} className="p-3 bg-slate-50 rounded-lg text-sm border border-slate-100">
                    <div className="font-semibold text-emerald-700">{item.type}</div>
                    <div className="text-slate-600 mt-1">{item.dates}</div>
                  </div>
                ))}
              </div>
            </div>

            <div className="bg-white p-5 rounded-2xl shadow-sm border border-slate-200">
              <h2 className="text-lg font-bold flex items-center gap-2 mb-4 text-slate-800">
                <MapPin className="w-5 h-5 text-blue-500" />
                우리 학군(북부) 평준화 일반고
              </h2>
              <div className="flex flex-wrap gap-2">
                {BUKBU_SCHOOLS.map(school => (
                  <span key={school} className="px-2.5 py-1 bg-blue-50 text-blue-700 rounded-full text-xs font-medium border border-blue-200">
                    {school}
                  </span>
                ))}
              </div>
            </div>
          </div>

          {/* 우측 패널: 등록 및 목록 */}
          <div className="lg:col-span-2 space-y-6">
            
            {/* 학생 등록 폼 */}
            <div className="bg-white p-5 rounded-2xl shadow-sm border border-slate-200 opacity-100 transition-opacity">
              <h2 className="text-lg font-bold flex items-center gap-2 mb-4 text-slate-800">
                <UserPlus className="w-5 h-5 text-indigo-500" />
                {currentClass}반 진학 희망 추가
              </h2>
              <form onSubmit={handleAddStudent} className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div className="flex gap-4">
                  <div className="w-1/3">
                    <label className="block text-xs font-semibold text-slate-500 mb-1">번호</label>
                    <input 
                      type="number" value={formNum} onChange={(e) => setFormNum(e.target.value)}
                      className="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 outline-none" 
                      placeholder="예: 1" disabled={!gasUrl || isSaving}
                    />
                  </div>
                  <div className="w-2/3">
                    <label className="block text-xs font-semibold text-slate-500 mb-1">이름</label>
                    <input 
                      type="text" value={formName} onChange={(e) => setFormName(e.target.value)}
                      className="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 outline-none" 
                      placeholder="예: 홍길동" disabled={!gasUrl || isSaving}
                    />
                  </div>
                </div>
                
                <div>
                  <label className="block text-xs font-semibold text-slate-500 mb-1">지원 전형 유형</label>
                  <select 
                    value={formType} onChange={(e) => setFormType(e.target.value)}
                    className="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 outline-none"
                    disabled={!gasUrl || isSaving}
                  >
                    {SCHEDULE_DATA.map(item => (
                      <option key={item.id} value={item.id}>{item.type}</option>
                    ))}
                  </select>
                </div>

                <div className="md:col-span-2 flex gap-4 items-end">
                  <div className="flex-1">
                    <label className="block text-xs font-semibold text-slate-500 mb-1">희망 고등학교명</label>
                    <input 
                      type="text" value={formSchoolName} onChange={(e) => setFormSchoolName(e.target.value)}
                      className="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 outline-none" 
                      placeholder="학교명을 입력하세요" disabled={!gasUrl || isSaving}
                    />
                  </div>
                  <button 
                    type="submit" 
                    disabled={!gasUrl || isSaving}
                    className="px-6 py-2.5 bg-emerald-600 hover:bg-emerald-700 disabled:bg-slate-400 text-white font-medium rounded-lg transition-colors whitespace-nowrap shadow-sm"
                  >
                    명단에 추가
                  </button>
                </div>
              </form>
            </div>

            {/* 학생 목록 테이블 */}
            <div className="bg-white p-0 rounded-2xl shadow-sm border border-slate-200 overflow-hidden relative">
              {/* 로딩 오버레이 */}
              {isSaving && (
                <div className="absolute inset-0 bg-white/50 backdrop-blur-[1px] z-10 flex items-center justify-center">
                  <div className="bg-white px-4 py-2 rounded-full shadow-lg flex items-center gap-2 text-emerald-700 font-bold text-sm">
                    <Loader2 className="w-5 h-5 animate-spin" /> 구글 시트에 기록 중...
                  </div>
                </div>
              )}

              <div className="p-5 border-b border-slate-200 flex justify-between items-center bg-slate-50">
                <h2 className="text-lg font-bold flex items-center gap-2 text-slate-800">
                  <CheckCircle className="w-5 h-5 text-green-500" />
                  {currentClass}반 접수 현황
                </h2>
                <div className="text-sm text-slate-500 font-medium">
                  {loading ? '데이터 불러오는 중...' : `총 ${myClassStudents.length}명`}
                </div>
              </div>
              
              <div className="overflow-x-auto">
                <table className="w-full text-left border-collapse">
                  <thead>
                    <tr className="bg-white border-b border-slate-200 text-sm text-slate-500">
                      <th className="p-4 font-semibold text-center w-16">번호</th>
                      <th className="p-4 font-semibold w-24">이름</th>
                      <th className="p-4 font-semibold">지원 학교 및 유형</th>
                      <th className="p-4 font-semibold text-center w-28">접수 상태</th>
                      <th className="p-4 font-semibold text-center w-16">관리</th>
                    </tr>
                  </thead>
                  <tbody>
                    {loading ? (
                      <tr>
                        <td colSpan="5" className="p-12 text-center text-slate-500 flex flex-col items-center justify-center">
                          <Loader2 className="w-8 h-8 animate-spin text-emerald-500 mb-3" />
                          구글 시트에서 {currentClass}반 데이터를 불러오는 중입니다...
                        </td>
                      </tr>
                    ) : myClassStudents.length === 0 ? (
                      <tr>
                        <td colSpan="5" className="p-12 text-center text-slate-400">
                          {gasUrl ? `아직 등록된 학생이 없습니다. 위 폼에서 ${currentClass}반 학생을 추가해주세요.` : '스프레드시트가 연결되지 않았습니다.'}
                        </td>
                      </tr>
                    ) : (
                      myClassStudents.map(student => (
                        <React.Fragment key={student.id}>
                          {student.applications.map((app, index) => {
                            const typeInfo = SCHEDULE_DATA.find(t => t.id === app.schoolType);
                            const isCompleted = app.status === 'completed';
                            const isLast = index === student.applications.length - 1;
                            
                            return (
                              <tr key={app.id} className={`hover:bg-slate-50 transition-colors ${isCompleted ? 'bg-slate-50/50' : ''} ${isLast ? 'border-b-2 border-slate-200' : 'border-b border-slate-100'}`}>
                                {index === 0 && (
                                  <td rowSpan={student.applications.length} className="p-4 text-center font-medium text-slate-700 bg-white border-r border-slate-100 align-middle">
                                    {student.num}
                                  </td>
                                )}
                                {index === 0 && (
                                  <td rowSpan={student.applications.length} className="p-4 font-semibold text-slate-800 bg-white border-r border-slate-100 align-middle">
                                    {student.name}
                                  </td>
                                )}
                                <td className="p-4">
                                  <div className="font-bold text-slate-800">{app.schoolName}</div>
                                  <div className="text-xs text-blue-600 mt-0.5">{typeInfo.type}</div>
                                </td>
                                <td className="p-4 text-center">
                                  <button 
                                    onClick={() => toggleStatus(student.id, app.id)}
                                    disabled={!gasUrl || isSaving}
                                    className={`inline-flex items-center justify-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-bold transition-colors w-full ${
                                      isCompleted 
                                      ? 'bg-green-100 text-green-700 hover:bg-green-200' 
                                      : 'bg-slate-100 text-slate-500 hover:bg-slate-200'
                                    }`}
                                  >
                                    {isCompleted ? <CheckCircle className="w-4 h-4" /> : <Circle className="w-4 h-4" />}
                                    {isCompleted ? '접수완료' : '접수전'}
                                  </button>
                                </td>
                                <td className="p-4 text-center">
                                  <button 
                                    onClick={() => requestDelete(student.id, app.id)}
                                    disabled={!gasUrl || isSaving}
                                    className="p-1.5 text-slate-400 hover:text-red-500 disabled:opacity-50 rounded transition-colors"
                                  >
                                    <Trash2 className="w-4 h-4" />
                                  </button>
                                </td>
                              </tr>
                            )
                          })}
                        </React.Fragment>
                      ))
                    )}
                  </tbody>
                </table>
              </div>
            </div>

          </div>
        </div>
      </div>

      {/* 스프레드시트 설정 모달 */}
      {isSettingsOpen && (
        <div className="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
          <div className="bg-white rounded-2xl p-6 sm:p-8 max-w-lg w-full shadow-2xl">
            <h3 className="text-xl font-bold mb-2 text-slate-800 flex items-center gap-2">
              <Database className="w-6 h-6 text-emerald-600" />
              구글 스프레드시트 연동
            </h3>
            <p className="text-slate-600 mb-6 text-sm leading-relaxed">
              가이드를 참고하여 발급받으신 <b>웹 앱 URL</b>을 아래에 붙여넣어 주세요.<br/>
              동료 선생님들께 사이트를 공유하실 때, 이 주소도 함께 알려주시면 다 같이 하나의 시트에 기록을 모을 수 있습니다.
            </p>
            
            <div className="mb-6">
              <label className="block text-sm font-bold text-slate-700 mb-2">웹 앱 URL (https://script.google.com/...)</label>
              <textarea 
                value={tempUrlInput}
                onChange={(e) => setTempUrlInput(e.target.value)}
                placeholder="여기에 복사한 URL을 붙여넣으세요"
                className="w-full p-3 border-2 border-slate-200 rounded-xl focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200 outline-none h-24 text-sm font-mono break-all"
              />
            </div>

            <div className="flex justify-end gap-3">
              <button 
                onClick={() => setIsSettingsOpen(false)} 
                className="px-5 py-2.5 font-bold text-slate-600 hover:bg-slate-100 rounded-xl transition-colors"
              >
                취소
              </button>
              <button 
                onClick={handleSaveSettings} 
                className="px-5 py-2.5 font-bold bg-emerald-600 text-white hover:bg-emerald-700 rounded-xl transition-colors"
              >
                저장 후 연동하기
              </button>
            </div>
          </div>
        </div>
      )}

      {/* 삭제 확인 모달 */}
      {deleteModal.isOpen && (
        <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
          <div className="bg-white rounded-xl p-6 max-w-sm w-full shadow-xl">
            <h3 className="text-lg font-bold mb-2 text-slate-800">지원 정보 삭제</h3>
            <p className="text-slate-600 mb-6 text-sm">정말 이 지원 희망 정보를 삭제하시겠습니까? (구글 시트에서도 삭제됩니다.)</p>
            <div className="flex justify-end gap-2">
              <button onClick={cancelDelete} className="px-4 py-2 font-medium text-slate-600 hover:bg-slate-100 rounded-lg transition-colors">취소</button>
              <button onClick={confirmDelete} className="px-4 py-2 font-medium bg-red-600 text-white hover:bg-red-700 rounded-lg transition-colors">삭제</button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}